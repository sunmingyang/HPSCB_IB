function do_arcotProcess(e){if(e)initArcotInline(e)}function initArcotInline(e){if(ar_clientsInited)return;ar_startTime=(new Date).getTime();ar_clientsInited=true;ar_start();ar_form=e;ArcotPref.execute();ar_clientType=ArcotPref.type;if(ArcotPref.error!="")ar_wfCode="103:"+ArcotPref.error;else if(ar_clientType=="")ar_wfCode="102";if(ar_clientType==""){try{var t=document.getElementById("2fanotsupported");if(t!=null)t.style.display="block"}catch(n){}return}ar_clientPath=contextPath+"/client";ar_initDidClient();ar_initAidClient();ar_initDnaClient();ar_checkLoaded()}function collectArcotData(e){ar_passwd=e;ar_submitted=true;var t=navigator.userAgent;t=t==null?"":t.toLowerCase();if(t.indexOf("msie")==-1)disableSubmit(true);ar_submitInternal()}function ar_initAidClient(){try{ar_progress+="|initAid1";ar_client=new ArcotClient;ar_client.setAttribute("clientBaseURL",ar_clientPath);ar_client.setAttribute("clientType",ar_clientType);ar_client.setAttribute("clientReadyCallback",ar_clientReady);ar_client.setAttribute("clientErrorCallback",ar_clientError);ar_client.write(ar_clientId);ar_aidInit=true;ar_progress+="|initAid2"}catch(e){ar_progress+="|initAid3-"+e;ar_wfCode=113}}function ar_initDidClient(){try{ar_progress+="|initDid1";if(ArcotPref.useFlash)ArcotDeviceDNA.initFlashObj(ar_clientPath,ar_form);if(ArcotPref.useApplet){ar_client2=new LT_ArcotClient;ar_client2.setAttribute("clientBaseURL",ar_clientPath);ar_client2.setAttribute("clientType",ar_clientType);ar_client2.setAttribute("clientReadyCallback",ar_clientReady2);ar_client2.setAttribute("clientErrorCallback",ar_clientError2);ar_client2.write(ar_clientId2)}if(ArcotPref.useJS);ar_didInit=true;if(ArcotPref.useFlash||ArcotPref.useJS)ar_clientReady2();ar_progress+="|initDid2"}catch(e){ar_progress+="|initDid3-"+e;ar_rfCode=113}}function ar_initDnaClient(){ar_progress+="|initDna1";if(!ArcotPref.useFlash){var e=document.getElementById("flashsetting");e.style.display="block"}ar_ipAddr=remoteAddr;var t=ar_isMESC;var n=ar_iterations;var r=0;var i=false;var s=500;var o=50;var u=false;var a=true;var f=500;var l=50;ar_rfCode=201;try{ar_progress+="|initDna2";ArcotDeviceDNA.setOutputFormatType(r);ArcotDeviceDNA.setLoadApplets(i);ArcotDeviceDNA.setMESCConfiguration(t,n,s,o);ArcotDeviceDNA.setDESCConfiguration(u,a,f,l);ArcotDeviceDNA.setExternalIP(ar_ipAddr);ArcotDeviceDNA.init(ar_clientPath,ar_form);ar_dnaInit=true;ar_progress+="|initDna3"}catch(c){ar_progress+="|initDna4-"+c;ar_rfCode=202}ar_checkDnaClient()}function ar_clientReady(){ar_aidFinish=true;ar_enableBrowser="Y";ar_wfCode=105}function ar_clientError(){ar_wfCode=104+":"+ar_client.GetErrorCode()}function ar_clientReady2(){ar_didFinish=true;ar_rfCode=105}function ar_clientError2(){ar_rfCode=104+":"+ar_client1.GetErrorCode()}function ar_checkDnaClient(){if(!ar_dnaInit)return;try{var e=ar_getField("isDNADone");var t=ar_getField("mescIterationCount");var n=ar_isMESC?t==ar_iterations:true;if(e=="true"&&n){ar_dnaFinish=true;return}setTimeout("ar_checkDnaClient()",250)}catch(r){}}function ar_start(){ar_stopped=false;disableSubmit(true);setTimeout("ar_timeout()",ar_timeout_period)}function ar_stop(){if(ar_stopped)return;var e=(new Date).getTime();ar_loadTime=e-ar_startTime;ar_stopped=true;disableSubmit(false)}function ar_checkLoaded(){if(ar_stopped)return;var e=true;e&=!ar_aidInit||ar_aidFinish;e&=!ar_didInit||ar_didFinish;e&=!ar_dnaInit||ar_dnaFinish;if(!e){setTimeout("ar_checkLoaded()",1e3);return}ar_stop()}function ar_timeout(){if(ar_stopped)return;if(!ar_aidFinish){ar_aidFound="TO";ar_setField("timeOutValue","Y")}ar_stop()}function ar_submitInternal(){ar_progress+="|submit1";ar_signChallenge();ar_progress+="|submit2";ar_getDna();ar_progress+="|submit3";ar_getDid();ar_progress+="|submit4";ar_setFields();ar_progress+="|submit5"}function ar_signChallenge(){if(!ar_aidFinish){ar_progress+="|sign0";return}ar_getWalletStats();ar_userid=ar_getField("CorporateSignonCorpId");var e=challenge;var t=appcttx;var n=orgname;if(n==null||t==null||ar_userid==null||ar_passwd==null||e==null){ar_sign="1014";return}var r=0;var i=0;var s=false;ar_aidFound="SCR";try{ar_progress+="|sign1";if(ArcotPref.useFlash||ArcotPref.useApplet||ArcotPref.useJS){if(!s){ar_client.SetAttribute("AID_LOOKUP_MODE","ALIAS_ONLY");s=ar_client.isArcotIDAvailableEx(ar_userid,t,n);r=ar_client.GetErrorCode();if(s){ar_aidFound="Found:Alias";ar_sign=ar_client.SignChallengeEx2(e,ar_passwd,ar_userid,t,n);ar_aidFound="SCP_ALIAS";i=ar_client.GetErrorCode()}}if(!s){ar_client.SetAttribute("AID_LOOKUP_MODE","USERNAME_ONLY");s=ar_client.isArcotIDAvailableEx(ar_userid,t,n);r=ar_client.GetErrorCode();if(s){ar_aidFound="Found:Username";ar_sign=ar_client.SignChallengeEx(e,ar_userid,"ARCARD",ar_passwd,n);ar_aidFound="SCP_UID";i=ar_client.GetErrorCode()}}}ar_progress+="|sign2";if(!s){ar_signCode=201+":"+r;ar_sign=ar_signCode;ar_progress+="|sign3";return}if(ar_sign==null||ar_sign.length<10){ar_signCode=211+":"+i;ar_sign=ar_signCode;ar_progress+="|sign4";return}ar_signCode=221;ar_progress+="|sign5"}catch(o){ar_progress+="|sign6-"+o;ar_sign="1002";return}}function ar_getDna(){if(!ar_dnaFinish){ar_progress+="|dna0";return}try{ar_progress+="|dna1";ArcotDeviceDNA.formatDNA();ar_dna=ar_getField("deviceDNA");ar_progress+="|dna2"}catch(e){ar_progress+="|dna3-"+e}}function ar_getDid(){if(ar_clientType==""){ar_deviceId="1004";return}if(!ar_didFinish){ar_progress+="|did0";if(ar_didInit)ar_deviceId="1003";return}try{ar_progress+="|did1";if(ArcotPref.useFlash){ArcotDeviceDNA.getFlashCookie("RISKFORT_COOKIE");ar_deviceId=ar_getField("arcotFlashCookie")+""}if(ArcotPref.useApplet)ar_deviceId=ar_client2.GetCookieByApplet("RISKFORT_COOKIE")+"";if(ArcotPref.useJS)ar_deviceId=getBrowserCookie("RISKFORT_COOKIE")+"";if(ar_deviceId!=null&&ar_deviceId.length>10)ar_rfCode=204;if(ar_deviceId==""||ar_deviceId=="undefined"||ar_deviceId=="null")ar_deviceId="";ar_progress+="|did2"}catch(e){ar_progress+="|did3-"+e;ar_deviceId="1002";ar_rfCode=205}}function ar_getWalletStats(){var e=new Array;try{ar_progress+="|stats1";ar_walletCount=ar_client.GetGlobalAttribute("walletn.count");for(var t=0;t<ar_walletCount&&t<7;t++){var n=ar_client.GetGlobalAttribute("walletn:"+t+":name");e[t]=n}ar_progress+="|stats2"}catch(r){ar_progress+="|stats3-"+r}ar_walletNames="["+e.toString()+"]"}function ar_extraLog(){var e="";e+=":flash="+(ArcotPref.enabledFlash?"enabled":"disabled");e+=":applet="+(ArcotPref.enabledApplet?"enabled":"disabled");e+=":javascript="+(ArcotPref.enabledJS?"enabled":"disabled");e+=":browser="+navigator.userAgent;e+=":arcotStatsWFCode="+ar_wfCode;e+=":arcotCLoadTime="+ar_loadTime;e+=":arcotStatsRFCode="+ar_rfCode;e+=":flashVersion="+ArcotPref.versionFlash;e+=":userIPAddress="+ar_ipAddr;e+=":signChallegeCode="+ar_signCode;e+=":arcotIDFound="+ar_aidFound;e+=":walletCount="+ar_walletCount;e+=":walletNames="+ar_walletNames;e+=":jreVersion="+ArcotPref.versionApplet;e+=":jreMechanism="+ArcotPref.jreMechanism;if(ar_rfCode!=204||ar_signCode!=221)e+=":progress="+ar_progress;return e}function disableSubmit(e){if(!e&&ar_submitted)return;window.status=""}function ar_setFields(){ar_setField("arcotClientType",ar_clientType);ar_setField("CallerID","123456");ar_setField("javascriptflag","enabled");ar_setField("flashflag",ArcotPref.enabledFlash?"enabled":"disabled");ar_setField("arcotEnableBrowser",ar_enableBrowser);ar_setField("DeviceID",ar_deviceId);ar_setField("cacheSignChallenge",ar_sign);ar_setField("MFP",ar_dna);ar_setField("ArcotIpAddress",ar_ipAddr);ar_setField("extralog",ar_extraLog())}function ar_setField(e,t){var n=ar_form.elements[e];if(typeof n!="undefined")n.value=t}function ar_getField(e){var t=ar_form.elements[e];if(typeof t!="undefined")return t.value;else return null}var ar_timeout_period=6e3;var ar_signon_period=1e3;var ar_aidInit=false;var ar_aidFinish=false;var ar_didInit=false;var ar_didFinish=false;var ar_dnaInit=false;var ar_dnaFinish=false;var ar_stopped=false;var ar_clientsInited=false;var ar_submitted=false;var ar_clientPath="";var ar_clientType="";var ar_client;var ar_client2;var ar_clientId="ArcotIDClient";var ar_clientId2="DeviceIdClient";var ar_isMESC=false;var ar_iterations=2;var ar_form=null;var ar_enableBrowser="N";var ar_wfCode=-1;var ar_rfCode=-1;var ar_deviceId="1001";var ar_sign="1001";var ar_dna="";var ar_signCode="";var ar_ipAddr="";var ar_startTime;var ar_loadTime=-1;var ar_aidFound="NA";var ar_walletNames="[]";var ar_walletCount=0;var ar_progress="";var ar_passwd=null;var ar_chall=null;var ar_passwd=null;var ar_userid=null;var ar_appctxt=null;var ar_org=null;